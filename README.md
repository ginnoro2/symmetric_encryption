# Symmetric Encryption Examples

This project demonstrates three types of symmetric encryption using Python and the PyCryptodome library:

- **Block Cipher (ECB mode)**
- **Block Cipher (CBC mode)**
- **Stream Cipher (AES-CTR mode)**

Each mode has its own encryption and decryption scripts, with clear examples and explanations.

---

## Prerequisites

- Python 3.7+
- [PyCryptodome](https://www.pycryptodome.org/)

Install dependencies in a virtual environment:

```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

---

## 1. Block Cipher: ECB Mode

**Purpose:**
- Demonstrates Electronic Codebook (ECB) mode, where each block is encrypted independently.
- Shows the weakness of ECB: identical plaintext blocks produce identical ciphertext blocks.

### Run Encryption
```bash
python3 ecb_example.py
```
**Output:**
```
ECB Mode Example:
Original Message: You are Ethical Hackers

Note: Same blocks produce same ciphertext, making patterns visible

Encrypted: cQMqCqwSEa5CkFQzxTv0ZZh7ZcToPubSTYxXpfRM6TM=
Decrypted: You are Ethical Hackers

Key and encrypted message have been saved for testing decryption
Run ecb_decrypt.py to test decryption
```

### Run Decryption
First, get the key in hex format:
```bash
cat ecb_key.txt | xxd -p
```
Then, get the encrypted message:
```bash
cat ecb_encrypted.txt
```
Now run:
```bash
echo -e "<KEY_HEX>\n<ENCRYPTED_MESSAGE>" | python3 ecb_decrypt.py
```
**Sample Output:**
```
Decrypted Message: You are Ethical Hackers
```

---

## 2. Block Cipher: CBC Mode

**Purpose:**
- Demonstrates Cipher Block Chaining (CBC) mode, where each block is XORed with the previous ciphertext block before encryption.
- Hides patterns in the plaintext, making it more secure than ECB.

### Run Encryption
```bash
python3 cbc_example.py
```
**Output:**
```
CBC Mode Example:
Original Message: HelloHelloHelloHello

Note: Each block is chained with previous block, hiding patterns

Encrypted: kH+wf2GfhNxP8OWf3tS6GavPRXvvL+guS40GPPYmAp4LwadSLTdj50wUfAXJUQ0+
Decrypted: HelloHelloHelloHello

Key and encrypted message have been saved for testing decryption
Run cbc_decrypt.py to test decryption
```

### Run Decryption
First, get the key in hex format:
```bash
cat cbc_key.txt | xxd -p
```
Then, get the encrypted message:
```bash
cat cbc_encrypted.txt
```
Now run:
```bash
echo -e "<KEY_HEX>\n<ENCRYPTED_MESSAGE>" | python3 cbc_decrypt.py
```
**Sample Output:**
```
Decrypted Message: HelloHelloHelloHello
```

---

## 3. Stream Cipher: AES-CTR Mode

**Purpose:**
- Demonstrates a stream cipher using AES in CTR (Counter) mode.
- Can encrypt data of any length, no padding required.
- Each byte is encrypted independently using a keystream.

### Run Encryption
```bash
python3 stream_cipher_example.py
```
**Output:**
```
Stream Cipher Example (using AES-CTR):

Note: Processes data byte by byte, no padding needed

Short Message Test:
Original: Short message
Encrypted: EFMOKJR/Uznc8oLAUCV1FbqcRxzV
Decrypted: Short message

Long Message Test:
Original: This is a longer message that demonstrates the flexibility of stream ciphers
Encrypted: HbDMim8jiAzFNE31hCHfnwUYR68Mb3idL2Xt+XuZCS+W0jOWN07HhupYGK+Q0j5gpq6soDvRlwe9JKwZT6C78FmmcOR+hu/12oS3tSQ8CxqhJSns
Decrypted: This is a longer message that demonstrates the flexibility of stream ciphers

Key and encrypted messages have been saved for testing decryption
Run stream_decrypt.py to test decryption
```

### Run Decryption
First, get the key in hex format:
```bash
cat stream_key.txt | xxd -p
```
Then, get the encrypted message (choose one line at a time):
```bash
cat stream_encrypted.txt
```
Now run:
```bash
echo -e "<KEY_HEX>\n<ENCRYPTED_MESSAGE>" | python3 stream_decrypt.py
```
**Sample Output:**
```
Decrypted Message: Short message
```
Or for the long message:
```
Decrypted Message: This is a longer message that demonstrates the flexibility of stream ciphers
```

---

## Notes
- Always use the key and encrypted message generated by the corresponding encryption script.
- The key is randomly generated each time you run an encryption script.
- The decryption scripts expect the key as a hex string and the encrypted message as base64.
- These examples are for educational purposes and should not be used for production security. 